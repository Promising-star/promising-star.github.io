(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1114],{23803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>R});var i=r(95155);r(92932);var s=r(12115),n=r(19279),o=r(39578),a=r(63646),l=r(36060),d=r(785),c=r(92199),g=r(14274),h=r(65614),p=r(2995),u=r(47975),f=r(62503),y=r(52492),x=r(8371),b=r(56418),m=r(67641),j=r(20063),S=r(37783),A=r(49621);let{Title:w,Text:v}=n.A,k=e=>{let{currentStep:t}=e,r=[{icon:(0,i.jsx)(c.A,{}),title:"绑定 Steam"},{icon:(0,i.jsx)(g.A,{}),title:"配对服务器"},{icon:(0,i.jsx)(h.A,{}),title:"设置用户页"}];return(0,i.jsx)("div",{className:"help-progress-indicator",style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:32,padding:"20px 0"},children:r.map((e,n)=>(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[(0,i.jsx)("div",{className:"help-step-icon",style:{width:44,height:44,borderRadius:12,background:n<t?"linear-gradient(135deg, #10b981 0%, #059669 100%)":n===t?"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)":"rgba(255, 255, 255, 0.05)",border:n<=t?"none":"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,color:n<=t?"#fff":"rgba(255, 255, 255, 0.3)",boxShadow:n===t?"0 4px 14px rgba(99, 102, 241, 0.4)":"none",transition:"all 0.3s ease"},children:n<t?(0,i.jsx)(p.A,{}):e.icon}),(0,i.jsx)(v,{style:{fontSize:12,color:n===t?"#fff":n<t?"#10b981":"rgba(255, 255, 255, 0.4)",fontWeight:n===t?600:400},children:e.title})]}),n<r.length-1&&(0,i.jsx)("div",{className:"help-step-line",style:{width:60,height:2,background:n<t?"linear-gradient(90deg, #10b981 0%, #10b981 100%)":"rgba(255, 255, 255, 0.1)",margin:"0 12px",marginBottom:28,borderRadius:1}})]},n))})};function R(){let e=(0,j.useRouter)(),[t,r]=(0,s.useState)(!1),[n,c]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),R=async()=>{try{c(!0);let e=await S.Aq.backendFetch("/api/f/saverusttoken",{method:"POST",body:JSON.stringify({token:""}),headers:{"Content-Type":"application/json"}}),t=await e.json();200===t.status&&(window.location.href="/admin")}catch(e){console.error("操作失败:",e)}finally{c(!1)}};return(0,s.useEffect)(()=>{let t=async()=>{try{let t=await S.Aq.backendFetch("/api/f/gethomepageinfo",{method:"POST"}),r=await t.json();if(200===r.status){if(r.data.appid&&p(!0),r.data.rustToken){let t=(e=>{try{let t=e.split(".")[0],r=atob(t);return JSON.parse(r).exp||null}catch(e){return null}})(r.data.rustToken);if(t&&Math.floor(Date.now()/1e3)>=t)return void e.push("/admin/help/rusttoken")}r.data.server&&Object.keys(r.data.server).length>0&&e.push("/admin/help/userpage")}}catch(e){console.error("检查状态失败:",e)}};t();let r=()=>t();return A.B.on("ADMIN_DATA_SERVER_UPDATE",r),()=>{A.B.off("ADMIN_DATA_SERVER_UPDATE",r)}},[e]),(0,i.jsxs)("div",{className:"help-page-container",style:{maxWidth:900,margin:"0 auto"},children:[!h&&(0,i.jsx)(k,{currentStep:1}),(0,i.jsx)(o.A,{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)",borderRadius:16,border:"none",marginBottom:24},children:(0,i.jsxs)(a.A,{direction:"vertical",size:8,children:[(0,i.jsxs)(a.A,{children:[(0,i.jsx)(g.A,{style:{fontSize:24,color:"#fff"}}),(0,i.jsx)(w,{level:4,style:{margin:0,color:"#fff"},children:h?"配对服务器":"第二步：配对服务器"})]}),(0,i.jsx)(v,{style:{color:"rgba(255,255,255,0.85)",fontSize:15},children:"进入游戏完成服务器配对，完成后将自动进入下一步"})]})}),(0,i.jsxs)("div",{className:"help-main-content",style:{display:"flex",gap:24,marginBottom:24},children:[(0,i.jsxs)(o.A,{style:{flex:1,background:"#27272c",borderRadius:16,border:"1px solid rgba(255,255,255,0.08)"},children:[(0,i.jsxs)(v,{strong:!0,style:{display:"block",marginBottom:20,color:"#fff",fontSize:15},children:[(0,i.jsx)(u.A,{style:{marginRight:8}}),"配对步骤"]}),(0,i.jsx)(a.A,{direction:"vertical",size:20,style:{width:"100%"},children:[{title:"按 ESC 打开游戏设置",desc:"在游戏中按 ESC 键打开设置菜单"},{title:"点击左上角「当前游戏」",desc:"在设置菜单左上角找到并点击"},{title:"点击「配对」按钮",desc:"点击 Pair With Server 按钮"},{title:"返回浏览器确认配对",desc:"在弹出的配对窗口中确认"}].map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:14},children:[(0,i.jsx)("div",{style:{width:32,height:32,borderRadius:10,background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:15,fontWeight:600,color:"#fff",flexShrink:0},children:t+1}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(v,{strong:!0,style:{display:"block",marginBottom:2,fontSize:14},children:e.title}),(0,i.jsx)(v,{type:"secondary",style:{fontSize:13},children:e.desc})]})]},t))}),(0,i.jsxs)("div",{style:{marginTop:20,background:"rgba(0,0,0,0.2)",borderRadius:12,padding:8,cursor:"pointer",position:"relative"},onClick:()=>r(!0),children:[(0,i.jsx)("img",{src:"https://www.rustplus.cn/pdgame/1.png",alt:"配对服务器流程",style:{borderRadius:8,width:"100%",height:"auto"}}),(0,i.jsxs)("div",{style:{position:"absolute",bottom:16,right:16,background:"rgba(0,0,0,0.6)",borderRadius:8,padding:"4px 8px",display:"flex",alignItems:"center",gap:4},children:[(0,i.jsx)(f.A,{style:{color:"#fff",fontSize:12}}),(0,i.jsx)(v,{style:{color:"#fff",fontSize:12},children:"点击放大"})]})]})]}),(0,i.jsxs)("div",{className:"help-sidebar",style:{width:320,display:"flex",flexDirection:"column",gap:16},children:[(0,i.jsxs)(o.A,{style:{background:"rgba(16, 185, 129, 0.1)",borderRadius:12,border:"1px solid rgba(16, 185, 129, 0.2)"},children:[(0,i.jsxs)(a.A,{align:"center",style:{marginBottom:8},children:[(0,i.jsx)(l.A,{indicator:(0,i.jsx)(y.A,{spin:!0,style:{color:"#10b981",fontSize:18}})}),(0,i.jsx)(v,{strong:!0,style:{color:"#6ee7b7"},children:"等待配对中..."})]}),(0,i.jsx)(v,{type:"secondary",style:{fontSize:13},children:"中转服务器已连接，配对成功后页面会自动跳转"})]}),(0,i.jsxs)(o.A,{style:{background:"rgba(99, 102, 241, 0.1)",borderRadius:12,border:"1px solid rgba(99, 102, 241, 0.2)"},children:[(0,i.jsxs)(a.A,{align:"start",style:{marginBottom:8},children:[(0,i.jsx)(x.A,{style:{color:"#818cf8",fontSize:18}}),(0,i.jsx)(v,{strong:!0,style:{color:"#a5b4fc"},children:"温馨提示"})]}),(0,i.jsx)(v,{type:"secondary",style:{fontSize:13},children:"配对过程中请保持此页面打开。如果没有自动跳转，请手动刷新页面。"})]}),(0,i.jsxs)(o.A,{style:{background:"rgba(245, 158, 11, 0.1)",borderRadius:12,border:"1px solid rgba(245, 158, 11, 0.2)",flex:1},children:[(0,i.jsxs)(a.A,{align:"start",style:{marginBottom:8},children:[(0,i.jsx)(b.A,{style:{color:"#f59e0b",fontSize:18}}),(0,i.jsx)(v,{strong:!0,style:{color:"#fcd34d"},children:"配对没有反应？"})]}),(0,i.jsx)(v,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:12},children:"可能是 Rust 凭证已过期，请重新获取凭证后再试"}),(0,i.jsx)(d.Ay,{icon:(0,i.jsx)(m.A,{}),onClick:R,loading:n,style:{height:36,borderRadius:8,background:"rgba(245, 158, 11, 0.2)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#fcd34d",boxShadow:"none"},children:"重新获取凭证"})]})]})]}),t&&(0,i.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.85)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},onClick:()=>r(!1),children:[(0,i.jsx)("img",{src:"https://www.rustplus.cn/pdgame/1.png",alt:"配对服务器流程",style:{maxWidth:"90%",maxHeight:"90%",borderRadius:12,boxShadow:"0 20px 60px rgba(0,0,0,0.5)"}}),(0,i.jsx)("div",{style:{position:"absolute",top:20,right:20,color:"#fff",fontSize:14,background:"rgba(255,255,255,0.1)",padding:"8px 16px",borderRadius:8},children:"点击任意位置关闭"})]})]})}},37783:(e,t,r)=>{"use strict";r.d(t,{Aq:()=>s,Ay:()=>n});let i=r(95704).env.NEXT_PUBLIC_GATEWAY_URL||"https://gateway.rustplus.cn";class s{static formatDateTime(e){let t=new Date(e),r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return"".concat(r,"-").concat(i,"-").concat(s," ").concat(n,":").concat(o)}static async copyToClipboard(e,t){let{onSuccess:r,onError:i}=t||{};try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),null==r||r(),!0;let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{let e=document.execCommand("copy");if(document.body.removeChild(t),e)return null==r||r(),!0}catch(e){throw document.body.removeChild(t),e}return window.prompt("复制失败，请手动复制以下文本:",e),null==r||r(),!0}catch(e){return null==i||i(e instanceof Error?e:Error(String(e))),!1}}static toBoolean(e){return"string"==typeof e?"true"===(e=e.toLowerCase().trim())||"1"===e:!!e}static getGatewayUrl(e){return e.startsWith("/api/pay/")||e.startsWith("/api/notice/")?"".concat(i).concat(e):e.startsWith("/api/")?"".concat(i,"/api/backend").concat(e.slice(4)):"".concat(i).concat(e)}static async backendFetch(e,t){return fetch(s.getGatewayUrl(e),{credentials:"include",...t}).then(e=>403===e.status?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(Error("Unauthorized"))):e).catch(e=>{throw e})}static getCookie(e){var t,r;let i="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===i.length)return null!=(r=null==(t=i.pop())?void 0:t.split(";").shift())?r:""}static detectDevice(){if("undefined"==typeof navigator)return{isMobile:!1,isWechat:!1,isIOS:!1,isAndroid:!1};let e=navigator.userAgent;return{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),isWechat:/MicroMessenger/i.test(e),isIOS:/iPhone|iPad|iPod/i.test(e),isAndroid:/Android/i.test(e)}}}let n={domain:"rustplus.cn",payWebUrl:"https://pay.rustplus.cn"}},49621:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});class i{emit(e,t){var r;null==(r=this.listeners[e])||r.forEach(e=>e(t))}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){var r;this.listeners[e]=null==(r=this.listeners[e])?void 0:r.filter(e=>e!==t)}constructor(){this.listeners={}}}let s=new i},62971:(e,t,r)=>{Promise.resolve().then(r.bind(r,23803))}},e=>{e.O(0,[4041,6083,785,6240,9279,2245,5445,6060,4540,9578,8607,3972,8441,1255,7358],()=>e(e.s=62971)),_N_E=e.O()}]);