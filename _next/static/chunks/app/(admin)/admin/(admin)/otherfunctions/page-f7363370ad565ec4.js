(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7148],{37783:(e,t,r)=>{"use strict";r.d(t,{Aq:()=>i,Ay:()=>n});let s="https://gateway.rustplus.cn";class i{static formatDateTime(e){let t=new Date(e),r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0");return"".concat(r,"-").concat(s,"-").concat(i," ").concat(n,":").concat(a)}static async copyToClipboard(e,t){let{onSuccess:r,onError:s}=t||{};try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),null==r||r(),!0;let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{let e=document.execCommand("copy");if(document.body.removeChild(t),e)return null==r||r(),!0}catch(e){throw document.body.removeChild(t),e}return window.prompt("复制失败，请手动复制以下文本:",e),null==r||r(),!0}catch(e){return null==s||s(e instanceof Error?e:Error(String(e))),!1}}static toBoolean(e){return"string"==typeof e?"true"===(e=e.toLowerCase().trim())||"1"===e:!!e}static getGatewayUrl(e){return e.startsWith("/api/pay/")||e.startsWith("/api/notice/")?"".concat(s).concat(e):e.startsWith("/api/")?"".concat(s,"/api/backend").concat(e.slice(4)):"".concat(s).concat(e)}static async backendFetch(e,t){return fetch(i.getGatewayUrl(e),{credentials:"include",...t}).then(e=>403===e.status?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(Error("Unauthorized"))):e).catch(e=>{throw e})}static getCookie(e){var t,r;let s="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===s.length)return null!=(r=null==(t=s.pop())?void 0:t.split(";").shift())?r:""}static detectDevice(){if("undefined"==typeof navigator)return{isMobile:!1,isWechat:!1,isIOS:!1,isAndroid:!1};let e=navigator.userAgent;return{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),isWechat:/MicroMessenger/i.test(e),isIOS:/iPhone|iPad|iPod/i.test(e),isAndroid:/Android/i.test(e)}}}let n={domain:"rustplus.cn",payWebUrl:"https://pay.rustplus.cn"}},51029:(e,t,r)=>{Promise.resolve().then(r.bind(r,82607))},82607:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(95155);r(92932);var i=r(12115),n=r(19279),a=r(49073),l=r(89543),o=r(39327),d=r(43561),c=r(36060),y=r(69887),p=r(59103),u=r(785),g=r(15856),h=r(15702),x=r(39286),b=r(57544),j=r(20058),m=r(88795),f=r(74722),v=r(26555),w=r(67153),S=r(56418),k=r(20063),A=r(37783);let{Text:R}=n.A,{TextArea:C}=a.A,T=A.Aq.backendFetch,B=[{value:"default",label:"【Rust工具箱】",preview:"【Rust工具箱】"},{value:"bracket_cn",label:"[Rust工具箱]",preview:"[Rust工具箱]"},{value:"plain_cn",label:"Rust工具箱 (带空格)",preview:"Rust工具箱 "},{value:"square_en",label:"【RustToolBox】",preview:"【RustToolBox】"},{value:"bracket_en",label:"[RustToolBox]",preview:"[RustToolBox]"},{value:"plain_en",label:"RustToolBox (带空格)",preview:"RustToolBox "}],z=[{key:"GlobalMessageSwitch",label:"全局信息开关",description:"控制是否向游戏服务器发送任何消息。关闭后，所有通知、报时、事件提醒、指令等消息都不会发送到游戏内聊天中。(指令控制全局信息开关除外)",isGlobal:!0}];function P(){var e;let{message:t,modal:r}=l.A.useApp(),[n,P]=(0,i.useState)({GlobalMessageSwitch:null}),[E,M]=(0,i.useState)(!0),[O,_]=(0,i.useState)(null),[G,D]=(0,i.useState)(null),[I,U]=(0,i.useState)(!1),[W,F]=(0,i.useState)(!1),[N,q]=(0,i.useState)("default"),[L,J]=(0,i.useState)(!1),H=(0,k.useRouter)();(0,i.useEffect)(()=>{Y()},[]);let Y=async()=>{try{M(!0),_(null);let t=await T("/api/f/getpreference",{method:"POST"}),r=await t.json();if(200===r.status){var e;P({GlobalMessageSwitch:(e=r.data.GlobalMessageSwitch,void 0===e||""===e||"false"!==e)}),q(r.data.MessagePrefix||"default")}else throw Error(r.errmessage||"Failed to fetch preference")}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";_(e),t.error("获取设置失败: ".concat(e))}finally{M(!1)}},K=async(e,r)=>{try{D(e);let s=await T("/api/f/setpreference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e,value:String(r)})}),i=await s.json();200===i.status?(P(t=>({...t,[e]:r})),t.success("设置已更新")):t.error(i.errmessage||"更新失败")}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";t.error("更新设置失败: ".concat(e)),Y()}finally{D(null)}},Q=async e=>{try{J(!0);let r=await T("/api/f/setpreference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"MessagePrefix",value:e})}),s=await r.json();200===s.status?(q(e),t.success("前缀设置已更新")):t.error(s.errmessage||"更新失败")}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";t.error("更新设置失败: ".concat(e))}finally{J(!1)}},V=async()=>{try{U(!0);let e=await T("/api/f/clearuserdata",{method:"POST"}),r=await e.json();200===r.status?(t.success("数据已清空"),F(!1),H.push("/admin")):t.error(r.errmessage||"清空数据失败")}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";t.error("清空数据失败: ".concat(e))}finally{U(!1)}},[X,Z]=(0,i.useState)(!1),[$,ee]=(0,i.useState)("encrypt"),[et,er]=(0,i.useState)(""),[es,ei]=(0,i.useState)(""),[en,ea]=(0,i.useState)(""),[el,eo]=(0,i.useState)(!1),ed=async()=>{if(!et.trim())return void t.warning("请输入要处理的文本");try{eo(!0),ea("");let e="encrypt"===$?"/api/encrypt":"/api/decrypt",r=await fetch("https://xy.rustplus.cn".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:et,...es.trim()?{key:es.trim()}:{}})}),s=await r.json();200===s.status?(ea(s.result),t.success("encrypt"===$?"加密成功":"解密成功")):10001===s.status?t.error("参数异常，请检查输入"):10002===s.status?t.error("encrypt"===$?"加密失败":"解密失败，密钥可能不匹配"):429===s.status?t.error("请求过于频繁，请稍后重试"):t.error("操作失败")}catch(e){t.error("网络错误，请稍后重试")}finally{eo(!1)}},ec=async()=>{en&&(await A.Aq.copyToClipboard(en),t.success("已复制到剪贴板"))};return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)("div",{style:{padding:24},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16,maxWidth:640},children:[(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{strong:!0,style:{fontSize:16},children:"事件通知设置"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"控制各类游戏事件的通知开关，关闭后将不再收到对应类型的通知。"})})]}),O&&(0,s.jsx)("div",{style:{marginBottom:12},children:(0,s.jsxs)(R,{type:"danger",children:["错误: ",O]})}),z.map((e,t)=>{var r;return(0,s.jsxs)(i.Fragment,{children:[t>0&&(0,s.jsx)(o.A,{style:{margin:"12px 0"}}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:16,...e.isGlobal?{padding:12,background:"rgba(255, 77, 79, 0.1)",borderRadius:8,border:"1px solid rgba(255, 77, 79, 0.3)"}:{}},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)(R,{strong:!0,style:e.isGlobal?{color:"#ff4d4f"}:void 0,children:[e.label,e.isGlobal&&(0,s.jsx)(d.A,{color:"red",style:{marginLeft:8},children:"重要"})]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:e.description})})]}),(0,s.jsx)("div",{children:E||null===n[e.key]?(0,s.jsx)(c.A,{size:"small"}):(0,s.jsx)(y.A,{checked:null==(r=n[e.key])||r,onChange:t=>K(e.key,t),disabled:null!==G,loading:G===e.key})})]})]},e.key)}),G&&(0,s.jsx)("div",{style:{marginTop:12},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"正在保存设置..."})})]}),(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsxs)(R,{strong:!0,style:{fontSize:16},children:[(0,s.jsx)(b.A,{style:{marginRight:8}}),"游戏信息前缀"]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"设置发送到游戏内聊天消息的前缀样式。"})})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[E?(0,s.jsx)(c.A,{size:"small"}):(0,s.jsx)(p.A,{value:N,onChange:Q,disabled:L,loading:L,style:{width:240},options:B.map(e=>({value:e.value,label:e.label}))}),(0,s.jsxs)(R,{type:"secondary",style:{fontSize:12},children:["预览: ",(0,s.jsxs)(R,{code:!0,children:[(null==(e=B.find(e=>e.value===N))?void 0:e.preview)||"【Rust工具箱】","你的消息内容"]})]})]})]}),(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsx)(R,{strong:!0,children:"星曰加密工具"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"用于在游戏中加密聊天，让队友之间的交流更加私密"})})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(u.Ay,{type:"primary",icon:(0,s.jsx)(j.A,{}),onClick:()=>Z(!0),children:"打开加密工具"}),(0,s.jsx)(u.Ay,{onClick:()=>{window.open("https://www.rustplus.cn/docs/xy.html","_blank")},children:"查看说明文档"})]})]}),(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255, 77, 79, 0.2)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{strong:!0,style:{color:"#ff4d4f"},children:"数据管理"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsxs)(R,{type:"secondary",style:{fontSize:12},children:["清空您的所有数据，包括服务器配置、开关、智能报警、指令逻辑、事件逻辑等。",(0,s.jsx)("br",{}),(0,s.jsx)(R,{type:"warning",style:{fontSize:12},children:"保留项：呼叫组、Rust凭证、用户偏好设置"})]})})]}),(0,s.jsx)(u.Ay,{danger:!0,type:"primary",icon:(0,s.jsx)(m.A,{}),onClick:()=>F(!0),style:{borderRadius:8,height:36,boxShadow:"none"},children:"清空数据"})]})]})}),(0,s.jsx)(g.A,{title:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(j.A,{style:{color:"#6366f1",fontSize:18}}),(0,s.jsx)("span",{children:"星曰加密工具"})]}),open:X,onCancel:()=>{Z(!1),er(""),ei(""),ea("")},footer:null,centered:!0,width:520,children:(0,s.jsxs)("div",{style:{padding:"8px 0"},children:[(0,s.jsx)("div",{style:{marginBottom:16},children:(0,s.jsx)(h.A,{value:$,onChange:e=>{ee(e),ea("")},options:[{label:(0,s.jsxs)("span",{children:[(0,s.jsx)(j.A,{})," 加密"]}),value:"encrypt"},{label:(0,s.jsxs)("span",{children:[(0,s.jsx)(f.A,{})," 解密"]}),value:"decrypt"}],block:!0,style:{marginBottom:8}})}),(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"encrypt"===$?"要加密的文本":"要解密的星曰密文"}),(0,s.jsx)(C,{value:et,onChange:e=>er(e.target.value),placeholder:"encrypt"===$?"输入要加密的内容...":"输入星曰密文...",autoSize:{minRows:3,maxRows:6},maxLength:9999,showCount:!0,style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8}})]}),(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:'密钥（选填，不填则使用默认密钥"星标"）'}),(0,s.jsx)(a.A,{value:es,onChange:e=>ei(e.target.value),placeholder:"输入自定义密钥...",style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8}})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16},children:[(0,s.jsx)(u.Ay,{type:"primary",icon:"encrypt"===$?(0,s.jsx)(j.A,{}):(0,s.jsx)(f.A,{}),onClick:ed,loading:el,style:{flex:1,height:40,borderRadius:8,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",border:"none"},children:"encrypt"===$?"加密":"解密"}),en&&(0,s.jsx)(x.A,{title:"将结果作为输入",children:(0,s.jsx)(u.Ay,{icon:(0,s.jsx)(v.A,{}),onClick:()=>{en&&(er(en),ea(""))},style:{height:40,borderRadius:8}})})]}),en&&(0,s.jsxs)("div",{style:{padding:12,borderRadius:8,background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"encrypt"===$?"加密结果":"解密结果"}),(0,s.jsx)(u.Ay,{type:"link",size:"small",icon:(0,s.jsx)(w.A,{}),onClick:ec,style:{padding:0,height:"auto",color:"#10b981"},children:"复制"})]}),(0,s.jsx)("div",{style:{padding:10,borderRadius:6,background:"rgba(0,0,0,0.2)",wordBreak:"break-all",maxHeight:150,overflowY:"auto"},children:(0,s.jsx)(R,{style:{color:"#6ee7b7"},children:en})})]}),(0,s.jsx)("div",{style:{marginTop:16,padding:10,borderRadius:6,background:"rgba(99, 102, 241, 0.1)",border:"1px solid rgba(99, 102, 241, 0.15)"},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"\uD83D\uDCA1 提示：解密时需要使用与加密时相同的密钥，否则无法正确解密。"})})]})}),(0,s.jsx)(g.A,{title:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(S.A,{style:{color:"#ff4d4f",fontSize:20}}),(0,s.jsx)("span",{children:"确认清空数据"})]}),open:W,onCancel:()=>F(!1),footer:[(0,s.jsx)(u.Ay,{onClick:()=>F(!1),style:{borderRadius:6,boxShadow:"none"},children:"取消"},"cancel"),(0,s.jsx)(u.Ay,{danger:!0,type:"primary",loading:I,onClick:V,style:{borderRadius:6,boxShadow:"none"},children:"确认清空"},"confirm")],centered:!0,width:420,children:(0,s.jsxs)("div",{style:{padding:"16px 0"},children:[(0,s.jsx)("div",{style:{padding:16,borderRadius:8,background:"rgba(255, 77, 79, 0.1)",border:"1px solid rgba(255, 77, 79, 0.2)",marginBottom:16},children:(0,s.jsx)(R,{strong:!0,style:{color:"#ff4d4f"},children:"⚠️ 此操作不可恢复！"})}),(0,s.jsx)(R,{style:{display:"block",marginBottom:12},children:"此操作将清空以下数据："}),(0,s.jsxs)("ul",{style:{paddingLeft:20,margin:"8px 0",color:"rgba(255,255,255,0.85)"},children:[(0,s.jsx)("li",{children:"服务器配置"}),(0,s.jsx)("li",{children:"所有配对设备"}),(0,s.jsx)("li",{children:"指令逻辑"}),(0,s.jsx)("li",{children:"事件逻辑"}),(0,s.jsx)("li",{children:"智能报警设置"})]}),(0,s.jsx)("div",{style:{padding:12,borderRadius:8,background:"rgba(250, 173, 20, 0.1)",border:"1px solid rgba(250, 173, 20, 0.2)",marginTop:16},children:(0,s.jsx)(R,{style:{color:"#faad14"},children:"保留项：呼叫组、Rust凭证、偏好设置、用户页设置"})})]})})]})}}},e=>{e.O(0,[4041,6083,785,6240,9279,2245,9543,6060,3621,9073,8260,5702,7565,8441,1255,7358],()=>e(e.s=51029)),_N_E=e.O()}]);