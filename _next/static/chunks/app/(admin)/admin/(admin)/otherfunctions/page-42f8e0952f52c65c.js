(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7148],{37783:(e,r,t)=>{"use strict";t.d(r,{Aq:()=>a,Ay:()=>i});let s="https://gateway.rustplus.cn";class a{static formatDateTime(e){let r=new Date(e),t=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0"),i=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a," ").concat(i,":").concat(n)}static async copyToClipboard(e,r){let{onSuccess:t,onError:s}=r||{};try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),null==t||t(),!0;let r=document.createElement("textarea");r.value=e,r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select();try{let e=document.execCommand("copy");if(document.body.removeChild(r),e)return null==t||t(),!0}catch(e){throw document.body.removeChild(r),e}return window.prompt("复制失败，请手动复制以下文本:",e),null==t||t(),!0}catch(e){return null==s||s(e instanceof Error?e:Error(String(e))),!1}}static toBoolean(e){return"string"==typeof e?"true"===(e=e.toLowerCase().trim())||"1"===e:!!e}static getGatewayUrl(e){return e.startsWith("/api/pay/")||e.startsWith("/api/notice/")?"".concat(s).concat(e):e.startsWith("/api/")?"".concat(s,"/api/backend").concat(e.slice(4)):"".concat(s).concat(e)}static async backendFetch(e,r){return fetch(a.getGatewayUrl(e),{credentials:"include",...r}).then(e=>403===e.status?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(Error("Unauthorized"))):e).catch(e=>{throw e})}static getCookie(e){var r,t;let s="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===s.length)return null!=(t=null==(r=s.pop())?void 0:r.split(";").shift())?t:""}static detectDevice(){if("undefined"==typeof navigator)return{isMobile:!1,isWechat:!1,isIOS:!1,isAndroid:!1};let e=navigator.userAgent;return{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),isWechat:/MicroMessenger/i.test(e),isIOS:/iPhone|iPad|iPod/i.test(e),isAndroid:/Android/i.test(e)}}}let i={domain:"rustplus.cn",payWebUrl:"https://pay.rustplus.cn"}},51029:(e,r,t)=>{Promise.resolve().then(t.bind(t,82607))},82607:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>M});var s=t(95155);t(92932);var a=t(12115),i=t(19279),n=t(49073),l=t(89543),o=t(36060),d=t(15702),c=t(39327),y=t(43561),p=t(69887),g=t(59103),u=t(785),h=t(15856),x=t(39286),b=t(57544),j=t(20058),m=t(88795),f=t(74722),v=t(26555),w=t(67153),S=t(56418),k=t(20063),A=t(37783);let{Text:R}=i.A,{TextArea:C}=n.A,T=A.Aq.backendFetch,B=[{value:"default",label:"【Rust工具箱】",preview:"【Rust工具箱】"},{value:"bracket_cn",label:"[Rust工具箱]",preview:"[Rust工具箱]"},{value:"plain_cn",label:"Rust工具箱 (带空格)",preview:"Rust工具箱 "},{value:"square_en",label:"【RustToolBox】",preview:"【RustToolBox】"},{value:"bracket_en",label:"[RustToolBox]",preview:"[RustToolBox]"},{value:"plain_en",label:"RustToolBox (带空格)",preview:"RustToolBox "}],z=[{key:"GlobalMessageSwitch",label:"全局信息开关",description:"控制是否向游戏服务器发送任何消息。关闭后，所有通知、报时、事件提醒、指令等消息都不会发送到游戏内聊天中。(指令控制全局信息开关除外)",isGlobal:!0}];function M(){var e;let{message:r,modal:t}=l.A.useApp(),[i,M]=(0,a.useState)({GlobalMessageSwitch:null}),[O,P]=(0,a.useState)(!0),[E,_]=(0,a.useState)(null),[G,D]=(0,a.useState)(null),[U,I]=(0,a.useState)(!1),[W,F]=(0,a.useState)(!1),[N,q]=(0,a.useState)("default"),[J,L]=(0,a.useState)(!1),[H,Y]=(0,a.useState)("game"),[K,Q]=(0,a.useState)(!1),V=(0,k.useRouter)();(0,a.useEffect)(()=>{X()},[]);let X=async()=>{try{P(!0),_(null);let r=await T("/api/f/getpreference",{method:"POST"}),t=await r.json();if(200===t.status){var e;M({GlobalMessageSwitch:(e=t.data.GlobalMessageSwitch,void 0===e||""===e||"false"!==e)}),q(t.data.MessagePrefix||"default"),Y(t.data.MessageSendMode||"game")}else throw Error(t.errmessage||"Failed to fetch preference")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";_(e),r.error("获取设置失败: ".concat(e))}finally{P(!1)}},Z=async(e,t)=>{try{D(e);let s=await T("/api/f/setpreference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e,value:String(t)})}),a=await s.json();200===a.status?(M(r=>({...r,[e]:t})),r.success("设置已更新")):r.error(a.errmessage||"更新失败")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";r.error("更新设置失败: ".concat(e)),X()}finally{D(null)}},$=async e=>{try{L(!0);let t=await T("/api/f/setpreference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"MessagePrefix",value:e})}),s=await t.json();200===s.status?(q(e),r.success("前缀设置已更新")):r.error(s.errmessage||"更新失败")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";r.error("更新设置失败: ".concat(e))}finally{L(!1)}},ee=async e=>{try{Q(!0);let t=await T("/api/f/setpreference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"MessageSendMode",value:e})}),s=await t.json();200===s.status?(Y(e),r.success("发送模式已更新")):r.error(s.errmessage||"更新失败")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";r.error("更新设置失败: ".concat(e))}finally{Q(!1)}},er=async()=>{try{I(!0);let e=await T("/api/f/clearuserdata",{method:"POST"}),t=await e.json();200===t.status?(r.success("数据已清空"),F(!1),V.push("/admin")):r.error(t.errmessage||"清空数据失败")}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";r.error("清空数据失败: ".concat(e))}finally{I(!1)}},[et,es]=(0,a.useState)(!1),[ea,ei]=(0,a.useState)("encrypt"),[en,el]=(0,a.useState)(""),[eo,ed]=(0,a.useState)(""),[ec,ey]=(0,a.useState)(""),[ep,eg]=(0,a.useState)(!1),eu=async()=>{if(!en.trim())return void r.warning("请输入要处理的文本");try{eg(!0),ey("");let e="encrypt"===ea?"/api/encrypt":"/api/decrypt",t=await fetch("https://xy.rustplus.cn".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:en,...eo.trim()?{key:eo.trim()}:{}})}),s=await t.json();200===s.status?(ey(s.result),r.success("encrypt"===ea?"加密成功":"解密成功")):10001===s.status?r.error("参数异常，请检查输入"):10002===s.status?r.error("encrypt"===ea?"加密失败":"解密失败，密钥可能不匹配"):429===s.status?r.error("请求过于频繁，请稍后重试"):r.error("操作失败")}catch(e){r.error("网络错误，请稍后重试")}finally{eg(!1)}},eh=async()=>{ec&&(await A.Aq.copyToClipboard(ec),r.success("已复制到剪贴板"))};return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)("div",{style:{padding:24},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16,maxWidth:640},children:[(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsxs)(R,{strong:!0,style:{fontSize:16},children:[(0,s.jsx)(b.A,{style:{marginRight:8}}),"工具箱消息发送模式"]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"控制服务器信息指令（如 .fwq）的消息发送方式。"})})]}),(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:O?(0,s.jsx)(o.A,{size:"small"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{value:H,onChange:ee,disabled:K,block:!0,options:[{label:"游戏内发送",value:"game"},{label:"用户页推送",value:"userpage"}]}),(0,s.jsx)("div",{style:{padding:10,borderRadius:6,background:"rgba(99, 102, 241, 0.1)",border:"1px solid rgba(99, 102, 241, 0.15)"},children:(0,s.jsxs)(R,{type:"secondary",style:{fontSize:12},children:["userpage"===H&&'\uD83D\uDCA1 消息仅显示在用户页的"工具箱消息"中，不会发送到游戏聊天',"game"===H&&"\uD83D\uDCA1 消息仅发送到游戏内聊天，不会显示在用户页（默认）"]})})]})})]}),"game"===H&&(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{strong:!0,style:{fontSize:16},children:"事件通知设置"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"控制各类游戏事件的通知开关，关闭后将不再收到对应类型的通知。"})})]}),E&&(0,s.jsx)("div",{style:{marginBottom:12},children:(0,s.jsxs)(R,{type:"danger",children:["错误: ",E]})}),z.map((e,r)=>{var t;return(0,s.jsxs)(a.Fragment,{children:[r>0&&(0,s.jsx)(c.A,{style:{margin:"12px 0"}}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:16,...e.isGlobal?{padding:12,background:"rgba(255, 77, 79, 0.1)",borderRadius:8,border:"1px solid rgba(255, 77, 79, 0.3)"}:{}},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)(R,{strong:!0,style:e.isGlobal?{color:"#ff4d4f"}:void 0,children:[e.label,e.isGlobal&&(0,s.jsx)(y.A,{color:"red",style:{marginLeft:8},children:"重要"})]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:e.description})})]}),(0,s.jsx)("div",{children:O||null===i[e.key]?(0,s.jsx)(o.A,{size:"small"}):(0,s.jsx)(p.A,{checked:null==(t=i[e.key])||t,onChange:r=>Z(e.key,r),disabled:null!==G,loading:G===e.key})})]})]},e.key)}),G&&(0,s.jsx)("div",{style:{marginTop:12},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"正在保存设置..."})})]}),"game"===H&&(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsxs)(R,{strong:!0,style:{fontSize:16},children:[(0,s.jsx)(b.A,{style:{marginRight:8}}),"游戏信息前缀"]}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"设置发送到游戏内聊天消息的前缀样式。"})})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[O?(0,s.jsx)(o.A,{size:"small"}):(0,s.jsx)(g.A,{value:N,onChange:$,disabled:J,loading:J,style:{width:240},options:B.map(e=>({value:e.value,label:e.label}))}),(0,s.jsxs)(R,{type:"secondary",style:{fontSize:12},children:["预览: ",(0,s.jsxs)(R,{code:!0,children:[(null==(e=B.find(e=>e.value===N))?void 0:e.preview)||"【Rust工具箱】","你的消息内容"]})]})]})]}),(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255,255,255,0.06)"},children:[(0,s.jsxs)("div",{style:{marginBottom:8},children:[(0,s.jsx)(R,{strong:!0,children:"星曰加密工具"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"用于在游戏中加密聊天，让队友之间的交流更加私密"})})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(u.Ay,{type:"primary",icon:(0,s.jsx)(j.A,{}),onClick:()=>es(!0),children:"打开加密工具"}),(0,s.jsx)(u.Ay,{onClick:()=>{window.open("https://www.rustplus.cn/docs/xy.html","_blank")},children:"查看说明文档"})]})]}),(0,s.jsxs)("div",{style:{padding:16,borderRadius:8,background:"rgba(255,255,255,0.02)",border:"1px solid rgba(255, 77, 79, 0.2)"},children:[(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{strong:!0,style:{color:"#ff4d4f"},children:"数据管理"}),(0,s.jsx)("div",{style:{marginTop:4},children:(0,s.jsxs)(R,{type:"secondary",style:{fontSize:12},children:["清空您的所有数据，包括服务器配置、开关、智能报警、指令逻辑、事件逻辑等。",(0,s.jsx)("br",{}),(0,s.jsx)(R,{type:"warning",style:{fontSize:12},children:"保留项：呼叫组、Rust凭证、用户偏好设置"})]})})]}),(0,s.jsx)(u.Ay,{danger:!0,type:"primary",icon:(0,s.jsx)(m.A,{}),onClick:()=>F(!0),style:{borderRadius:8,height:36,boxShadow:"none"},children:"清空数据"})]})]})}),(0,s.jsx)(h.A,{title:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(j.A,{style:{color:"#6366f1",fontSize:18}}),(0,s.jsx)("span",{children:"星曰加密工具"})]}),open:et,onCancel:()=>{es(!1),el(""),ed(""),ey("")},footer:null,centered:!0,width:520,children:(0,s.jsxs)("div",{style:{padding:"8px 0"},children:[(0,s.jsx)("div",{style:{marginBottom:16},children:(0,s.jsx)(d.A,{value:ea,onChange:e=>{ei(e),ey("")},options:[{label:(0,s.jsxs)("span",{children:[(0,s.jsx)(j.A,{})," 加密"]}),value:"encrypt"},{label:(0,s.jsxs)("span",{children:[(0,s.jsx)(f.A,{})," 解密"]}),value:"decrypt"}],block:!0,style:{marginBottom:8}})}),(0,s.jsxs)("div",{style:{marginBottom:12},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"encrypt"===ea?"要加密的文本":"要解密的星曰密文"}),(0,s.jsx)(C,{value:en,onChange:e=>el(e.target.value),placeholder:"encrypt"===ea?"输入要加密的内容...":"输入星曰密文...",autoSize:{minRows:3,maxRows:6},maxLength:9999,showCount:!0,style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8}})]}),(0,s.jsxs)("div",{style:{marginBottom:16},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:'密钥（选填，不填则使用默认密钥"星标"）'}),(0,s.jsx)(n.A,{value:eo,onChange:e=>ed(e.target.value),placeholder:"输入自定义密钥...",style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8}})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16},children:[(0,s.jsx)(u.Ay,{type:"primary",icon:"encrypt"===ea?(0,s.jsx)(j.A,{}):(0,s.jsx)(f.A,{}),onClick:eu,loading:ep,style:{flex:1,height:40,borderRadius:8,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",border:"none"},children:"encrypt"===ea?"加密":"解密"}),ec&&(0,s.jsx)(x.A,{title:"将结果作为输入",children:(0,s.jsx)(u.Ay,{icon:(0,s.jsx)(v.A,{}),onClick:()=>{ec&&(el(ec),ey(""))},style:{height:40,borderRadius:8}})})]}),ec&&(0,s.jsxs)("div",{style:{padding:12,borderRadius:8,background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"encrypt"===ea?"加密结果":"解密结果"}),(0,s.jsx)(u.Ay,{type:"link",size:"small",icon:(0,s.jsx)(w.A,{}),onClick:eh,style:{padding:0,height:"auto",color:"#10b981"},children:"复制"})]}),(0,s.jsx)("div",{style:{padding:10,borderRadius:6,background:"rgba(0,0,0,0.2)",wordBreak:"break-all",maxHeight:150,overflowY:"auto"},children:(0,s.jsx)(R,{style:{color:"#6ee7b7"},children:ec})})]}),(0,s.jsx)("div",{style:{marginTop:16,padding:10,borderRadius:6,background:"rgba(99, 102, 241, 0.1)",border:"1px solid rgba(99, 102, 241, 0.15)"},children:(0,s.jsx)(R,{type:"secondary",style:{fontSize:12},children:"\uD83D\uDCA1 提示：解密时需要使用与加密时相同的密钥，否则无法正确解密。"})})]})}),(0,s.jsx)(h.A,{title:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)(S.A,{style:{color:"#ff4d4f",fontSize:20}}),(0,s.jsx)("span",{children:"确认清空数据"})]}),open:W,onCancel:()=>F(!1),footer:[(0,s.jsx)(u.Ay,{onClick:()=>F(!1),style:{borderRadius:6,boxShadow:"none"},children:"取消"},"cancel"),(0,s.jsx)(u.Ay,{danger:!0,type:"primary",loading:U,onClick:er,style:{borderRadius:6,boxShadow:"none"},children:"确认清空"},"confirm")],centered:!0,width:420,children:(0,s.jsxs)("div",{style:{padding:"16px 0"},children:[(0,s.jsx)("div",{style:{padding:16,borderRadius:8,background:"rgba(255, 77, 79, 0.1)",border:"1px solid rgba(255, 77, 79, 0.2)",marginBottom:16},children:(0,s.jsx)(R,{strong:!0,style:{color:"#ff4d4f"},children:"⚠️ 此操作不可恢复！"})}),(0,s.jsx)(R,{style:{display:"block",marginBottom:12},children:"此操作将清空以下数据："}),(0,s.jsxs)("ul",{style:{paddingLeft:20,margin:"8px 0",color:"rgba(255,255,255,0.85)"},children:[(0,s.jsx)("li",{children:"服务器配置"}),(0,s.jsx)("li",{children:"所有配对设备"}),(0,s.jsx)("li",{children:"指令逻辑"}),(0,s.jsx)("li",{children:"事件逻辑"}),(0,s.jsx)("li",{children:"智能报警设置"})]}),(0,s.jsx)("div",{style:{padding:12,borderRadius:8,background:"rgba(250, 173, 20, 0.1)",border:"1px solid rgba(250, 173, 20, 0.2)",marginTop:16},children:(0,s.jsx)(R,{style:{color:"#faad14"},children:"保留项：呼叫组、Rust凭证、偏好设置、用户页设置"})})]})})]})}}},e=>{e.O(0,[4041,6083,785,6240,9279,2245,9543,6060,3621,9073,8260,5702,7565,8441,1255,7358],()=>e(e.s=51029)),_N_E=e.O()}]);