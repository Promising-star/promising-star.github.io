"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4533],{37783:(e,t,r)=>{r.d(t,{Aq:()=>o,Ay:()=>s});let a="http://gateway.rustplus.cn";class o{static formatDateTime(e){let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return"".concat(r,"-").concat(a,"-").concat(o," ").concat(s,":").concat(i)}static async copyToClipboard(e,t){let{onSuccess:r,onError:a}=t||{};try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),null==r||r(),!0;let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{let e=document.execCommand("copy");if(document.body.removeChild(t),e)return null==r||r(),!0}catch(e){throw document.body.removeChild(t),e}return window.prompt("复制失败，请手动复制以下文本:",e),null==r||r(),!0}catch(e){return null==a||a(e instanceof Error?e:Error(String(e))),!1}}static toBoolean(e){return"string"==typeof e?"true"===(e=e.toLowerCase().trim())||"1"===e:!!e}static getGatewayUrl(e){return e.startsWith("/api/pay/")||e.startsWith("/api/notice/")?"".concat(a).concat(e):e.startsWith("/api/")?"".concat(a,"/api/backend").concat(e.slice(4)):"".concat(a).concat(e)}static async backendFetch(e,t){return fetch(o.getGatewayUrl(e),{credentials:"include",...t}).then(e=>403===e.status?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(Error("Unauthorized"))):e).catch(e=>{throw e})}static getCookie(e){var t,r;let a="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===a.length)return null!=(r=null==(t=a.pop())?void 0:t.split(";").shift())?r:""}static detectDevice(){if("undefined"==typeof navigator)return{isMobile:!1,isWechat:!1,isIOS:!1,isAndroid:!1};let e=navigator.userAgent;return{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),isWechat:/MicroMessenger/i.test(e),isIOS:/iPhone|iPad|iPod/i.test(e),isAndroid:/Android/i.test(e)}}}let s={domain:"rustplus.cn",payWebUrl:"https://pay.rustplus.cn"}},50329:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(12115);let o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};var s=r(26240);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}let n=a.forwardRef((e,t)=>a.createElement(s.A,i({},e,{ref:t,icon:o})))},54533:(e,t,r)=>{r.d(t,{default:()=>S});var a=r(95155);r(92932);var o=r(12115),s=r(19279),i=r(89543),n=r(86133),c=r(39578),d=r(63646),l=r(81184),p=r(65982),u=r(49073),g=r(785),h=r(39286),m=r(79),b=r(50329),y=r(87365),x=r(52492),f=r(67153),j=r(20058),w=r(37783);let A=w.Aq.backendFetch,{Text:v,Title:k}=s.A;function S(e){let{callback:t}=e,{message:r}=i.A.useApp(),[s,S]=(0,o.useState)(null),[C,P]=(0,o.useState)(!0),[R,E]=(0,o.useState)(!1),[M,O]=(0,o.useState)(!1),[T]=n.A.useForm(),F=()=>{let e="abcdefghijklmnopqrstuvwxyz",t=Math.floor(5*Math.random())+6,r="";for(let a=0;a<t;a++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},B=async()=>{let e=T.getFieldValue("password");if(!e||""===e.trim()){r.success("未修改密码"),t&&t("password");return}try{E(!0);let a=await A("/api/f/setpassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})}),o=await a.json();200===o.status?(r.success("密码更新成功"),t&&t("password"),T.setFieldsValue({password:""})):r.error(o.errmessage||"密码更新失败")}catch(e){console.error("Error updating password:",e)}finally{E(!1)}},z=async()=>{try{O(!0);let e=await T.validateFields(["account"]),a=await A("/api/f/setappid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appid:e.account})}),o=await a.json();200===o.status?(S(e.account),r.success("账号更新成功"),t&&t("path")):r.error(o.errmessage||"账号更新失败")}catch(e){console.error("Error updating account:",e)}finally{O(!1)}},W=async()=>{try{P(!0);let e=await A("/api/f/getinfo",{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();200===t.status&&(S(t.data.appid),T.setFieldsValue({account:t.data.appid}))}catch(e){r.error("获取数据失败")}finally{P(!1)}};(0,o.useEffect)(()=>{W()},[]);let _=["admin","superadmin","administrator","sysadmin","root","system","server","api","backend","dashboard","login","logout","signin","signout","register","signup","auth","authentication","oauth","password","reset-password","forgot-password","verify","account","home","index","main","welcome","profile","settings","config","configuration","preferences","user","users","member","members","customer","customers","create","edit","update","delete","remove","list","manage","search","query","result","detail","view","show","download","upload","app","application","web","website","service","db","database","cache","log","logs","debug","test","testing","dev","development","stage","staging","prod","production","status","health","monitor","secure","security","private","public","protected","restricted","permission","role","roles","access","blog","post","posts","article","articles","news","event","events","product","products","shop","store","cart","checkout","order","orders","payment","payments","invoice","invoices","billing","contact","about","help","faq","support","terms","privacy","policy","legal","copyright","license"];return(0,a.jsx)(o.Fragment,{children:(0,a.jsxs)(c.A,{title:(0,a.jsxs)(d.A,{children:[(0,a.jsx)(m.A,{}),(0,a.jsx)("span",{children:"用户页设置"})]}),loading:C,style:{background:"#27272c",borderRadius:16,border:"1px solid rgba(255,255,255,0.08)"},children:[(0,a.jsx)("div",{style:{padding:"14px 16px",background:"rgba(99, 102, 241, 0.1)",borderRadius:12,border:"1px solid rgba(99, 102, 241, 0.2)",marginBottom:20},children:(0,a.jsx)(v,{style:{color:"rgba(255,255,255,0.85)",fontSize:14,lineHeight:1.7},children:"用户页可以让您的队友通过网页控制您配对的智能开关，无需登录您的账号。设置账号和密码后，将其分享给队友即可。"})}),(0,a.jsxs)(n.A,{form:T,layout:"vertical",children:[(0,a.jsxs)("div",{style:{padding:20,background:"rgba(255, 255, 255, 0.03)",borderRadius:14,border:"1px solid rgba(255, 255, 255, 0.06)",marginBottom:20},children:[(0,a.jsxs)(k,{level:5,style:{marginBottom:16,color:"rgba(255,255,255,0.85)"},children:[(0,a.jsx)(b.A,{style:{marginRight:8}}),"用户页账号"]}),(0,a.jsxs)(l.A,{gutter:[16,16],align:"middle",children:[(0,a.jsx)(p.A,{xs:24,md:16,children:(0,a.jsx)(n.A.Item,{name:"account",rules:[{validator:(e,t)=>t?t.length>32?Promise.reject(Error("账号长度不能超过32个字符")):_.includes(t.toLowerCase())?Promise.reject(Error("不能使用保留关键字")):/^[a-zA-Z0-9_-]+$/.test(t)?Promise.resolve():Promise.reject(Error("只能包含字母、数字、_和-")):Promise.reject(Error("请输入用户页账号"))}],style:{marginBottom:0},children:(0,a.jsx)(u.A,{autoComplete:"off",placeholder:"设置用户页账号",style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:12,height:48}})})}),(0,a.jsx)(p.A,{xs:24,md:8,children:(0,a.jsxs)(d.A,{wrap:!0,children:[(0,a.jsx)(g.Ay,{type:"primary",icon:(0,a.jsx)(y.A,{}),onClick:z,loading:M,style:{height:44,borderRadius:12,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",border:"none"},children:"保存"}),(0,a.jsx)(g.Ay,{icon:(0,a.jsx)(x.A,{}),onClick:()=>T.setFieldsValue({account:F()}),style:{height:44,borderRadius:12,background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)"},children:"随机"})]})})]}),s&&(0,a.jsxs)("div",{style:{marginTop:16,padding:"12px 16px",background:"rgba(16, 185, 129, 0.1)",borderRadius:10,border:"1px solid rgba(16, 185, 129, 0.2)",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:[(0,a.jsxs)(d.A,{children:[(0,a.jsx)(v,{type:"secondary",children:"当前账号:"}),(0,a.jsx)(v,{style:{color:"#10b981",fontWeight:500,fontSize:15},children:s})]}),(0,a.jsx)(h.A,{title:"复制账号",children:(0,a.jsx)(g.Ay,{type:"text",size:"small",icon:(0,a.jsx)(f.A,{}),onClick:async()=>{await w.Aq.copyToClipboard(s),r.success("账号已复制")},style:{color:"#10b981"}})})]})]}),(0,a.jsxs)("div",{style:{padding:20,background:"rgba(255, 255, 255, 0.03)",borderRadius:14,border:"1px solid rgba(255, 255, 255, 0.06)"},children:[(0,a.jsxs)(k,{level:5,style:{marginBottom:16,color:"rgba(255,255,255,0.85)"},children:[(0,a.jsx)(j.A,{style:{marginRight:8}}),"用户页密码"]}),(0,a.jsxs)(l.A,{gutter:[16,16],align:"middle",children:[(0,a.jsx)(p.A,{xs:24,md:16,children:(0,a.jsx)(n.A.Item,{name:"password",rules:[{max:20,message:"密码长度不能超过20个字符"}],style:{marginBottom:0},children:(0,a.jsx)(u.A.Password,{autoComplete:"off",placeholder:"设置新密码（留空则不修改）",style:{background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:12,height:48}})})}),(0,a.jsx)(p.A,{xs:24,md:8,children:(0,a.jsxs)(d.A,{wrap:!0,children:[(0,a.jsx)(g.Ay,{type:"primary",icon:(0,a.jsx)(y.A,{}),onClick:B,loading:R,style:{height:44,borderRadius:12,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",border:"none"},children:"保存"}),(0,a.jsx)(g.Ay,{icon:(0,a.jsx)(x.A,{}),onClick:()=>T.setFieldsValue({password:F()}),style:{height:44,borderRadius:12,background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)"},children:"随机"})]})})]}),(0,a.jsx)(v,{type:"secondary",style:{display:"block",marginTop:12,fontSize:13},children:"队友访问用户页时需要输入此密码"})]})]})]})})}},92932:(e,t,r)=>{var a=r(79484),o=r(12669);(0,a.L)(function(e,t){t._reactRoot||(t._reactRoot=(0,o.createRoot)(t));var r=t._reactRoot;return r.render(e),function(){return new Promise(function(e){setTimeout(function(){r.unmount(),e()},0)})}})}}]);